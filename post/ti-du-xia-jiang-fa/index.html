<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>梯度下降法 | 张曼</title>
<link rel="shortcut icon" href="https://zhangman123456.github.io/favicon.ico?v=1590114712385">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://zhangman123456.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="梯度下降法 | 张曼 - Atom Feed" href="https://zhangman123456.github.io/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="#基本思想：
　　假设我们爬山，如果想最快的上到山顶，那么我们应该从山势最陡的地方上山。也就是山势变化最快的地方上山
　　同样，如果从任意一点出发，需要最快搜索到函数最大值，那么我们也应该从函数变化最快的方向搜索。函数变化最快的方向是什么呢..." />
    <meta name="keywords" content="" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://zhangman123456.github.io">
  <img class="avatar" src="https://zhangman123456.github.io/images/avatar.png?v=1590114712385" alt="">
  </a>
  <h1 class="site-title">
    张曼
  </h1>
  <p class="site-description">
    温故而知新
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          首页
        </a>
      
    
      
        <a href="/archives" class="menu">
          归档
        </a>
      
    
      
        <a href="/tags" class="menu">
          标签
        </a>
      
    
      
        <a href="/post/about" class="menu">
          关于
        </a>
      
    
  </div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              梯度下降法
            </h2>
            <div class="post-info">
              <span>
                2020-05-21
              </span>
              <span>
                5 min read
              </span>
              
            </div>
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <p>#基本思想：<br>
　　假设我们爬山，如果想最快的上到山顶，那么我们应该从山势最陡的地方上山。也就是山势变化最快的地方上山<br>
　　同样，如果从任意一点出发，需要最快搜索到函数最大值，那么我们也应该从函数变化最快的方向搜索。函数变化最快的方向是什么呢？函数的<em>梯度</em>。<br>
　　如果函数为一元函数，梯度就是该函数的导数 <img src="https://zhangman123456.github.io/post-images/1590077120801.png" alt="" loading="lazy"><br>
　　如果为二元函数，梯度定义为：<img src="https://zhangman123456.github.io/post-images/1590077189972.png" alt="" loading="lazy">　<br>
　　如果需要找的是函数极小点，那么应该从负梯度的方向寻找，该方法称之为<strong>梯度下降法</strong>。如下图：<br>
<img src="https://zhangman123456.github.io/post-images/1590077297157.png" alt="" loading="lazy"><br>
　　函数值减小的方向称为负梯度。<br>
　　要搜索极小值C点，在A点必须向x增加方向搜索，此时与A点梯度方向相反；在B点必须向x减小方向搜索，此时与B点梯度方向相反。总之，搜索极小值，必须向负梯度方向搜索。<br>
#步骤：<br>
　　假设函数   y= f(x₁，x₂……xn) 只有一个极小点。初始给定参数为  X = (x10，x20，……xn0)。从这个点如何搜索才能找到原函数的极小值点？<br>
　　1.首先设定一个较小的正数η，ε;<br>
　　2. 求当前位置处的各个偏导数：<img src="https://zhangman123456.github.io/post-images/1590077961405.png" alt="" loading="lazy"><br>
　　3. 修改当前函数的参数值，公式如下：<img src="https://zhangman123456.github.io/post-images/1590077999929.png" alt="" loading="lazy"><br>
　　4. 如果参数变化量小于ε，退出；否则返回2。<br>
#实例：（该实例来自wls的课件，我自己修改成了我更容易理解的方式）<br>
实例：利用梯度下降法求函数    y=x2/2-2x   的极小值。<br>
首先 1. 任意给一个初始出发点，设为 x₁=-4；设参数变化量为△x。<br>
　　２. 给定任意两个较小的参数：η = 0.9，ε = 0.01<br>
　　３.   计算导数：f'(x) ＝ dy/dx = x - 2<br>
　　 注：如果△x&lt;ε ,终止循环，输出x₁；<br>
　　　　 如果△x&gt;ε，继续循环。<br>
　　(这些是准备工作)<br>
第一轮循环：1. 计算当前导数值：f'(x₁) = -4 - 2 = -6；<br>
　　　　　　２.修改当前参数值：x₁ = x₁ - η*f'(x₁) = -4 - 0.9* (-6) = 1.4；<br>
　　　　　　　　　　　　　　　△x = -0.9*(-6) = 5.4；<br>
　　　　　　３. 将△x与ε 进行比较，△x = 5.4 &gt; ε = 0.01；△x&gt;ε，继续循环。<br>
第二轮循环：1.更新当前导数值：f'(x₁) = 1.4 - 2 = -0.6;<br>
　　　　　　2.修改当前参数值：x₁ = x₁ - η*f'(x₁) = 1.4 - 0.9*(-0.6) = 1.94；<br>
　　　　　　　　　　　　　　   △x = -0.9*(- 0.6) = 0.54；<br>
　　　　　　3.将△x与ε 进行比较，△x =0.54  &gt; ε = 0.01；△x&gt;ε，继续循环。<br>
第三轮循环：1.更新当前导数值：f'(x₁) = 1.94 - 2 = -0.06；<br>
　　　　　　2.修改当前参数值：x₁ = x₁ - η*f'(x₁) = 1.94 - 0.9*(-0.06) = 1.994;<br>
　　　　　　　　　　　　　　  △x = -0.9*(-0.06) = 0.054；<br>
　　　　　　3.将△x与ε 进行比较，△x =0.０54  &gt; ε = 0.01；△x&gt;ε，继续循环。　　　　<br>
第四轮循环：１.更新当前导数值：f'(x₁) = 1.994 - 2 = 0.006；<br>
　　　　　　 2.修改当前参数值：x₁ = x₁ - η*f'(x₁) = 1.994 - 0.9*(-0.006) = 1.9994;　　　　　　　　　　　<br>
　　　　　　　　　　　　　　　△x = -0.9*(0.006) = 0.0054；<br>
　　　　　　 3.将△x与ε 进行比较，△x =0.0054  &gt; ε = 0.01；如果△x&lt;ε ,终止循环，输出x₁。<br>
＃解决实例的Python代码<br>
import numpy as np<br>
inport matplotlib as mpl<br>
import matplotlib.pyplot as plt</p>
<p>mpl.rcParams['font.family'] = 'sans-serif'<br>
mpl.rcParams['font.sans-serif'] = 'SimHei'<br>
mpl.rcParams['axes.unicode_minus'] = false</p>
<p>#构建一维元素图形<br>
def f1(x):<br>
　　return 0.5 * (x ** 2) - 2x<br>
def h1(x):<br>
　　return x-2</p>
<p>#使用梯度下降法<br>
GD_X = []<br>
GD_Y = []<br>
x = -4<br>
alpha = 0.9<br>
f_change = np.abs(alpha * hl(x))<br>
f_current = f_change<br>
GD_X.append(x)<br>
GD_Y.append(f_current)</p>
<p>#迭代次数<br>
iter_num = 0<br>
while f_change &gt;0.01 and iter_num&lt;10:<br>
　　iter_num+=1<br>
　　x = x - x - alpha * h1(x)<br>
　　tem = f1(x)<br>
　　f_change = np.abs(alpha * hl(x))<br>
　　f_current = tmp<br>
　　GD_X.append(f_current)</p>
<p>print(u'最终的结果：(%.5f,%.5f)'%(x,f_current))<br>
pirnt(u'迭代次数：%d'%iter_num)<br>
printf(GD_X)</p>

              </div>
              <div class="toc-container">
                
              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">下一篇</div>
            <a href="https://zhangman123456.github.io/post/wo-de-bo-ke/">
              <h3 class="post-title">
                我的博客
              </h3>
            </a>
          </div>
        

        

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
  <a class="rss" href="https://zhangman123456.github.io/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
